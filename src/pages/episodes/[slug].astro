---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const episodes = await getCollection("episodes");

  return episodes.map((e) => ({
    params: { slug: e.id },
    props: { episode: e },
  }));
}

const { slug } = Astro.params;
if (!slug) throw new Error("Missing slug param");

const episode = Astro.props.episode;
if (!episode) {
  throw new Error(`Missing episode prop for slug "${slug}"`);
}

const { data } = episode;
---

<BaseLayout
  bgFrom={data.fromColor}
  bgTo={data.toColor}
  accent={data.accentColor}
  title={data.name}
>
  <div class="text-[var(--accent)] space-y-4 [view-transition-name:episode]">
    <h1 class="text-3xl md:text-4xl font-bold">{data.name}</h1>
    <p class="opacity-90 leading-relaxed">{data.description}</p>

    <div class="rounded-2xl p-6 border border-black/10"></div>

    <a
      href="#"
      class="inline-block mt-4 px-4 py-2 rounded-xl font-semibold text-white"
      style="background: var(--accent);"
    >
      Spill av episoden
    </a>
  </div>
</BaseLayout>
